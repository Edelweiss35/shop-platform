{% extends 'basecart.html' %}
{% load static %}
{% load widget_tweaks %}

{% block content %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Address</title>
    
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="robots" content="all,follow">

    <!-- Price Slider Stylesheets -->
    <link rel="stylesheet" href="{% static 'js/vendor/nouislider/nouislider.css' %}">
    <!-- Google fonts - Playfair Display-->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Playfair+Display:400,400i,700">
    <link rel="stylesheet" href="{% static 'css/fonts/hkgrotesk/stylesheet.css'}">
    <!-- owl carousel-->
    <link rel="stylesheet" href="{% static 'css/vendor/owl.carousel/assets/owl.carousel.css' %}">
    <!-- Ekko Lightbox-->
    <link rel="stylesheet" href="{% static 'css/vendor/ekko-lightbox/ekko-lightbox.css' %}">
    <!-- theme stylesheet-->
    <link rel="stylesheet" href="{% static 'css/style.default.css' %}" id="theme-stylesheet">
    <!-- Custom stylesheet - for your changes-->
  
    <!-- Favicon-->
    <link rel="shortcut icon" href="{% static 'img/favicon.png' %}">
    <!-- Tweaks for older IEs--><!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
        <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
    <!-- Font Awesome CSS-->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/solid.css" integrity="sha384-TbilV5Lbhlwdyc4RuIV/JhD8NR+BfMrvz4BL5QFa2we1hQu6wvREr3v6XSRfCTRp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/regular.css" integrity="sha384-avJt9MoJH2rB4PKRsJRHZv7yiFZn8LrnXuzvmZoD3fh1aL6aM6s0BBcnCvBe6XSD" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/brands.css" integrity="sha384-7xAnn7Zm3QC1jFjVc1A6v/toepoG3JXboQYzbM0jrPzou9OFXm/fY6Z/XiIebl/k" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/fontawesome.css" integrity="sha384-ozJwkrqb90Oa3ZNb+yKFW2lToAWYdTiF1vt8JiH5ptTGHTGcN7qdoR1F95e0kYyG" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.js"integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>

  </head>
  <body>
      <script>
          $.get( "{% url 'storefront:product_list_api' %}", function( shopy ) {
            var shopx = $.parseJSON(shopy)
            console.log(shopx);
            var description = shopx.shop_description
            var shop_name = shopx.shop_name
            var phone = shopx.shop_phone
            $('#title').html(shop_name);
            $('#phone').html(phone);
            $('#contacts').html(phone);
            $('#contact').html(phone);
            $("#nav_shop_name").html(shop_name);
            $("#shop_description").html(description);
            $("#nav_shop_name").html(shop_name);
            $("#main_block").html(shop_name);
            $("#footer").html(shop_name);
            "text-uppercase"
          });
        </script>

<script>
    var prices = []
    var quantity = []
    $.get("{% url 'orders:order_api' %}", function( data ) {
      console.log(data)
      var datax = $.parseJSON(data)
      var result = []
      for( var key in datax){
        myValue = datax[key]; 
        console.log(myValue)
      }
      for (var {fields: n,} of datax){
        console.log(n)
      prices.push(parseInt(n.price))
      quantity.push(n.quantity);
      }
      total_quantity = quantity.reduce(function (a, b) {
      return a + b;
      });

      total_price = prices.reduce(function (a, b) {
      return a + b;
        });
      console.log('quantity total',total_quantity)
      console.log('prices total',total_price)
      cart = total_quantity * total_price
      
      console.log('cart total:',cart);
      $("#order_total").html(cart);
      $("#sum_order_total").html(cart);
      });
    </script>





<script>
    $.get( "{% url 'cart:cart_api' %}", function( data ) {
    console.log(data)
    var python_list = $.parseJSON(data);
    var quantity = [];
    var price = [];
    var product = [];
    var total_price = [];
    var array_of_numbers = python_list;
    function separate_the_data(value, i) {
    switch( i % 4) {
    case 0: quantity.push(value); break;
    case 1: price.push(value); break;
    case 2: product.push(value); break;
    case 3: total_price.push(value); break;
    }
    }
    python_list.map(separate_the_data);
    console.log('quantity',quantity);
    for (index = 0; index < quantity.length; index++) {
    console.log(quantity[index]);
    } 
    text = "<ul>";
    for (i = 0; i < quantity.length; i++) {
    text += "<li>" + quantity[i] + "</li>";
    }
    text += "</ul>";            
    quantity_total = quantity.reduce(add,0)
    function add(a, b) {
       return a + b;
     }
    console.log('quantity total',quantity_total);
    $('#quantity_total').html(quantity_total);
    console.log('price',price);
    for (index = 0; index < price.length; index++) { 
    //$('#price').html(price[index]);
    console.log(price[index]); 
    } 
    console.log('product',product)
    for (index = 0; index < product.length; index++) {
    console.log(product[index]); 
    } 
    product_text = "<ul>";
    for (i = 0; i < product.length; i++) {
    product_text += "<li>" + product[i] + "</li>";
    }
    product_text += "</ul>"; 
    console.log('total_price',total_price)
    for (index = 0; index < total_price.length; index++) { 
    console.log(total_price[index]); 
    } 
    price_text = "<ul>";
    for (i = 0; i < total_price.length; i++) {
    price_text += "<p>" + total_price[i] + "</p>";
    }
    price_text += "</ul>"; 
    cart = "<a>";
    for (i = 0; i < total_price.length; i++) {
    cart += "<li>"+  "<a> " + product[i]+ "</a>" + quantity[i] + total_price[i]+"</li>";
   $('#cart_item').append( "<br>"+"<strong >"+ "Item:" +product[i]+ "</stong>","<div>"+ "Quatity:"+quantity[i]+ "</div>","<strong>"+ "Ksh:" +total_price[i]+ "</stong>" +"</br>" );
    }
    cart += "</a>";
    total_price_sum = total_price.reduce(add,0)
    function add(a, b) {
       return a + b;
     }
    console.log('total_price',total_price_sum);
    $('#total_price').html(total_price_sum);
    $('#sub_total_price').html(total_price_sum);
    $('#sum_total_price').html(total_price_sum);
    });
    </script>

    <header class="header">
      <!-- Top Bar-->
      <div class="top-bar">
          <div class="container-fluid">
            <div class="row d-flex align-items-center">
              <div class="col-sm-7 d-none d-sm-block">
                <ul class="list-inline mb-0">
                  <li class="list-inline-item pr-3 mr-0" id = "phone">
                  </li>
                  <li class="list-inline-item px-3 border-left d-none d-lg-inline-block" ></li>
                </ul>
              </div>
              <div class="col-sm-5 d-flex justify-content-end">
                </div>
              </div>
            </div>
          </div>
      </div>
      <!-- Top Bar End-->
      <!-- Navbar-->
      <nav class="navbar navbar-expand-lg navbar-sticky navbar-light bg-white bg-fixed-white">
        <div class="container-fluid">  
          <!-- Navbar Header  --><a href="{% url 'storefront:product_list'%}" class="navbar-brand"><span class="font-weight-bold text-uppercase" id="title">Sell<span class="text-primary">.</span>  </span></a>
          <button type="button" data-toggle="collapse" data-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler navbar-toggler-right"><i class="fa fa-bars"></i></button>
          <!-- Navbar Collapse -->
          <div id="navbarCollapse" class="collapse navbar-collapse">
            <ul class="navbar-nav mx-auto">
            </ul>
            <div class="right-col d-flex align-items-center justify-content-between justify-content-lg-end my-3 my-lg-0">
              <div class="nav-item dropdown"><a href="#" class="navbar-icon-link d-lg-none"> 
                  <div class="d-none d-lg-block"><a id="cartdetails" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" href="#" class="navbar-icon-link dropdown-toggle">
                      <img src="{% static  'img/favicon.png' %}" alt = "" width="30" height="30"> 
                        <div class="navbar-icon-link-badge" id = "quantity_total">                        </div></a>
                      <div aria-labelledby="cartdetails" class="dropdown-menu dropdown-menu-right p-4">
                        <!-- cart item-->
                        <div class="navbar-cart-product"> 
                          <div class="d-flex align-items-center"><a href="#"></a>
                            <div class="d-flex w-100 justify-content-between">
                              <div class="pl-3" id = "cart_item"> <a href="#" class="navbar-cart-product-link" id="product"></a><small class="d-block text-muted" id="quantity">  </small><strong class="d-block text-sm" id="price"></strong></div>
                            </div>
                          </div>
                        </div>
                        <!-- total price-->
                        <div class="navbar-cart-total"><span class="text-uppercase text-muted">Total</span>Ksh<strong class="text-uppercase" id="total_price"></strong></div>
                        <!-- buttons-->
                        <div class="d-flex justify-content-between"><a href="{% url 'cart:cart_detail' %}"  class="btn btn-link text-dark mr-3">View Cart <i class="fa-arrow-right fa"></i></a><a href="{% url 'orders:order_create' %}" class="btn btn-outline-dark">Checkout</a></div>
                      </div>
                    </div>
              </div>
            </div>
          </div>
        </div>
      </nav>
      <!-- /Navbar -->
     
      
    </header>
    <!-- Hero Section-->
    <section class="hero">
      <div class="container">
        <!-- Breadcrumbs -->
        <ol class="breadcrumb justify-content-center">
          <li class="breadcrumb-item"><a href="/storefront">Home</a></li>
          <li class="breadcrumb-item active">Checkout        </li>
        </ol>
        <!-- Hero Content-->
        <div class="hero-content pb-5 text-center">
          <h1 class="hero-heading">Checkout</h1>
          <div class="row">   
            <div class="col-xl-8 offset-xl-2"><p class="lead text-muted">Please fill in your address.</p></div>
          </div>
        </div>
      </div>
    </section>
    <!-- Checkout-->
    <section>
      <div class="container">
        <div class="row">
          <div class="col-lg-8">
            <ul class="custom-nav nav nav-pills mb-5">
              <li class="nav-item w-25"><a href="{% url 'orders:order_create' %}" class="nav-link text-sm active">Address</a></li>
              <li class="nav-item w-25"><a href="#" class="nav-link text-sm disabled">Delivery Method</a></li>
              <li class="nav-item w-25"><a href="#" class="nav-link text-sm disabled">Payment Method </a></li>
              <li class="nav-item w-25"><a href="#" class="nav-link text-sm disabled">Order Review</a></li>
            </ul>
            <form method="post">
              <div class="block">
                <!-- Invoice Address-->
                <div class="block-header">
                  <h6 class="text-uppercase mb-0">Invoice address & Shipping addresss                    </h6>
                </div>
                <div class="block-body">
                  <div class="row">
                    <div class="form-group col-md-6">
                      <div>
                      {% csrf_token %}
                      {{ form.as_p }}
                      </div>
                    </div>
                    <div class="form-group col-12 mt-3">
                    </div>
                  </div>
                  <!-- /Invoice Address-->
                </div>
                <!-- Shippping Address-->
                <div id="shippingAddress" aria-expanded="false" class="collapse">
                    <div class="block">
                      <div class="block-header">
                        <h6 class="text-uppercase mb-0">Shipping address </h6>
                      </div>
                      <div class="block-body">
                        <div class="row">
                          <div class="form-group col-md-6">
                            <label for="street_shipping" class="form-label">Street</label>
                            <input type="text" name="street_shipping" placeholder="123 Main St." id="street_shipping" class="form-control">
                          </div>
                          <div class="form-group col-md-6">
                            <label for="city_shipping" class="form-label">City</label>
                            <input type="text" name="city_shipping" placeholder="City" id="city_shipping" class="form-control">
                          </div>
                          <div class="form-group col-md-6">
                            <label for="zip_shipping" class="form-label">ZIP</label>
                            <input type="text" name="zip_shipping" placeholder="Postal code" id="zip_shipping" class="form-control">
                          </div>
                          <div class="form-group col-md-6">
                            <label for="state_shipping" class="form-label">State</label>
                            <input type="text" name="state_shipping" placeholder="State" id="state_shipping" class="form-control">
                          </div>
                          <div class="form-group col-md-6">
                            <label for="phonenumber_shipping" class="form-label">Phone Number</label>
                            <input type="text" name="phonenumber_shipping" placeholder="Phone Number" id="phonenumber_shipping" class="form-control">
                          </div>
                        </div>
                      </div>
                    </div>
                  <!-- /Shipping Address-->
                </div>
              </div>
              
              <div class="mb-5 d-flex justify-content-between flex-column flex-lg-row"><a href="{% url 'cart:cart_detail' %}" class="btn btn-link text-muted"> <i class="fa fa-angle-left mr-2"></i>Back </a> <button type="submit" class="btn btn-dark" >Choose delivery method<i class="fa fa-angle-right ml-2"></i></a></button></div>
              
            </form>
          </div>
          <div class="col-lg-4">
            <div class="block mb-5">
              <div class="block-header">
                <h6 class="text-uppercase mb-0">Order Summary</h6>
              </div>
              <div class="block-body bg-light pt-1">
                <p class="text-sm">Shipping and additional costs are calculated based on values you have entered.</p>
                <ul class="order-summary mb-0 list-unstyled">
                  <li class="order-summary-item"  ><span>Order Subtotal Ksh</span><span id="sub_total_price"></span></li>
                  <li class="order-summary-item border-0" ><span>Total  Ksh</span><strong class="order-summary-total" id="sum_total_price"></strong></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Footer-->
    <footer class="main-footer">
        <!-- Services block-->
        <div class="bg-gray-100 text-dark-700 py-6">
          <div class="container">
            <div class="row">
              <div class="col-lg-4 service-column">
                <svg class="svg-icon service-icon">
                  <use xlink:href="#delivery-time-1"> </use>
                </svg>
                <div class="service-text">
                  <h6 class="text-uppercase">Delivery &amp; return</h6>
                  <p class="text-muted font-weight-light text-sm mb-0"></p>
                </div>
              </div>
              <div class="col-lg-4 service-column">
                <svg class="svg-icon service-icon">
                  <use xlink:href="#money-1"> </use>
                </svg>
                <div class="service-text">
                  <h6 class="text-uppercase">Money back guarantee</h6>
                  <p class="text-muted font-weight-light text-sm mb-0">30 Days Money Back Guarantee</p>
                </div>
              </div>
              <div class="col-lg-4 service-column">
                <svg class="svg-icon service-icon">
                  <use xlink:href="#customer-support-1"> </use>
                </svg>
                <div class="service-text">
                  <h6 class="text-uppercase" id = "contacts">020-800-456-747</h6>
                  <p class="text-muted font-weight-light text-sm mb-0">24/7 Available Support</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- Main block - menus, subscribe form-->
        <div class="py-6 bg-gray-300 text-muted"> 
          <div class="container">
            <div class="row">
              <div class="col-lg-4 mb-5 mb-lg-0">
                <div class="font-weight-bold text-uppercase text-lg text-dark mb-3" id="main_block">Sell<span class="text-primary">.</span></div>
                <p id="shop_description">.</p>
             
              </div>
             
           
              
            </div>
          </div>
        </div>
        <!-- Copyright section of the footer-->
        <div class="py-4 font-weight-light bg-gray-800 text-gray-300">
          <div class="container">
            <div class="row align-items-center">
              <div class="col-md-6 text-center text-md-left">
                <p class="mb-md-0" id ="footer" > <p>&copy; 2018   All rights reserved.</p></p>
              </div>
              <div class="col-md-6">
                <ul class="list-inline mb-0 mt-2 mt-md-0 text-center text-md-right">
                    <li class="list-inline-item"><img src="{% static 'img/visa.jpeg'%}" alt="..."  width="50" height="30"></li>
                    <li class="list-inline-item"><img src="{% static 'img/mpesa.jpeg' %}" alt="..."  width="50" height="30"></li>
                    <li class="list-inline-item"><img src="{% static  'img/eazzypay.jpeg' %}" alt="..."  width="50" height="30"></li>
                </ul>
              </div>
            </div>
          </div>
        </div>
      </footer>
      <!-- /Footer end-->
      <div id="scrollTop"><i class="fa fa-long-arrow-alt-up"></i></div>
      <!-- JavaScript files-->
      <script>
        // ------------------------------------------------------- //
        //   Inject SVG Sprite - 
        //   see more here 
        //   https://css-tricks.com/ajaxing-svg-sprite/
        // ------------------------------------------------------ //
  
        
      </script>
      <script src="https://code.jquery.com/jquery-3.3.1.js"integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js" integrity="sha384-ZMP7rVo3mIykV+2+9J3UJ46jBk0WLaUAdn689aCwoqbBJiSnjAK/l8WvCWPIPm49" crossorigin="anonymous"></script>
      <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/js/bootstrap.min.js" integrity="sha384-smHYKdLADwkXOn1EmN1qk/HfnUcbVRZyYmZ4qpPea6sjB/pTJ0euyQp0Mk8ck+5T" crossorigin="anonymous"></script>
      <script src="{% static 'js/vendor/jquery.cookie/jquery.cookie.js' %}"> </script>
      <script src="{% static 'js/vendor/owl.carousel/owl.carousel.js'%}"></script>
      <script src="{% static 'js/vendor/owl.carousel2.thumbs/owl.carousel2.thumbs.min.js'%}"></script>
      <script src="{% static 'js/vendor/nouislider/nouislider.js'%}"></script>
      <script src="{% static 'js/vendor/smooth-scroll/smooth-scroll.polyfills.min.js' %}"></script>
      <script src="{% static 'js/vendor/ekko-lightbox/ekko-lightbox.min.js'%}"></script>
      <script src="{% static 'js/theme.js' %}"></script>
    </body>
  </html>
  {%endblock%}